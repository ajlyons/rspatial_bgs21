<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Getting Data from APIs  " />
  <meta name="copyright" content="<span class='footer-right'><a href='../acknowledgements.html'>Acknowledgements</a></span><span class='footer-right'><a href=' https://etherpad.wikimedia.org/p/rspatial-bgs21 ' target='_blank'>Forum</a></span><span class='footer-right'><a href=' https://ajlyons.github.io/rspatial_bgs21 '> https://ajlyons.github.io/rspatial_bgs21 </a></span><span class='footer-right'><a href='../index.html'>Home</a></span><span class='footer-subtitle'> Spatial Data Analysis with R </span>"/>
  <meta name="font-size-adjustment" content="2"/>
  <title>Spatial Data Analysis with R  BayGeo, Spring 2021</title>
  <style type="text/css">
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
          </style>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACkUlEQVQ4jX2SW0jTcRTHTzNyeZlh6lqmm3POdNPC6SxSEzaqafkykOFoIxTDWpKRFV6iQMNLFyMSsQvUW0WORc2WWBmGKEGZXUyz0NrmNmfa1PYgfHsQ1v5oHjgvX875/M45vy/R8mDJ9caxrFIL5CUWJB00Q9n+7Q+l1BetUMuMTL3JpTB0QVnejd1Hu9DQ60G5eQbqB7PIvj0L2bUZ0KZzghWbs0o7Fx3Tc/B6vStm6+g0wrQvIKh2gKKyUxnNSZoO685SC1YDeL1e9Ll+Ia7WCd5pJ4hojQ8g1nViezETYBqZx93BOdwa9jAgsdUT4J6ZQqC6f4GIiLYU9/RzNWYIdU9hd/8rLjN7UGT8DbWROVVMlQsBBWas142DiIikdfbFMF0POIVm2NzM1zwLS+mvcSsnEajpBSv/8RIgucGJ1EYXEs+NwjrlWfUGMee/Y2PFJIJLrFibex8kOsahhCYnUlpnIL1kh9X9/yMKG2yIOOlAsPYnAveZsE75EEQUQLwTwy5Rsxvx9UxApKEPEYY+BiSizA623oaggkdgq4xLKwRLq7i8sy6EFlpg8wNEVwyAd3wAbZ8cPu3CazeCC/sRojYjaL8Jvm8MPWLDBm03A8CveQ9+7RBia4cYU4QfeokwzTOwc6/4OzKXHap/C5ufD0RNo0i4OAZR81dcnnD69Mp3PxBe9GRkuZdFKk7sqTcQ132EpGUMydetSLnpgOSGHVtbxpHU9AX8mkFEG55/ZrjQL1h82V6esPLVh8Sr40i940J6xzzS7s1C0m6HqHEEiTnatgT5gcPijHxltFwhjpRIQpZjBAJ2lFTBFW5TiOPT8mXx6apdcRl5OaJM1Q6hLC9ls3RPTLgok0NELCKiv02kPqt/O1MZAAAAAElFTkSuQmCC" rel="icon" type="image/x-icon" />
  <script language="javascript" type="text/javascript">
  function TriShowHide(shID) {
    shIDspan = shID + "span";
    shIDdiv = shID + "div";
    if (document.getElementById(shIDdiv).style.display != 'block') {
      document.getElementById(shIDdiv).style.display = 'block';
      txtSpan = "&#9660;";
    } else {
      document.getElementById(shIDdiv).style.display = 'none';
      txtSpan = "&#9654;";
    }
    document.getElementById(shIDspan).innerHTML = txtSpan + " ";
  }
  function showHide(shID) {
    if (shID=="soln-show-all") {
      var allAnswerCode = document.getElementsByClassName("answer-code");
      for (i = 0; i < allAnswerCode.length; i++) {
          allAnswerCode[i].style.display = 'block';
      }
    } else if (shID=="soln-hide-all") {
      var allAnswerCode = document.getElementsByClassName("answer-code");
      for (i = 0; i < allAnswerCode.length; i++) {
          allAnswerCode[i].style.display = 'none';
      }
    } else if (shID=="hints-show-all") {
      var allAnswerCode = document.getElementsByClassName("hint");
      for (i = 0; i < allAnswerCode.length; i++) {
          allAnswerCode[i].style.display = 'block';
      }
    } else if (shID=="hints-hide-all") {
      var allAnswerCode = document.getElementsByClassName("hint");
      for (i = 0; i < allAnswerCode.length; i++) {
          allAnswerCode[i].style.display = 'none';
      }
    } else {
      if (document.getElementById(shID)) {
        if (document.getElementById(shID).style.display != 'block') {
          document.getElementById(shID).style.display = 'block';
        } else {
          document.getElementById(shID).style.display = 'none';
        }
      }
    }
  }
  function CopyToClipboard(containerid) {
  if (document.selection) {
      var range = document.body.createTextRange();
      range.moveToElementText(document.getElementById(containerid));
      range.select().createTextRange();
      document.execCommand("copy");
  } else if (window.getSelection) {
      var range = document.createRange();
      range.selectNode(document.getElementById(containerid));
      window.getSelection().addRange(range);
      document.execCommand("copy");
      // alert("text copied")
  }}
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163964617-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-163964617-1');
  </script>
  <script src="lib/header-attrs-2.6/header-attrs.js"></script>
  <link href="lib/slidy-2/styles/slidy.css" rel="stylesheet" />
  <script src="lib/slidy-2/scripts/slidy.js"></script>
  <script src="lib/slidy_shiny-1/slidy_shiny.js"></script>
  <script src="lib/clipboard-1.7.1/clipboard.min.js"></script>
  <link href="lib/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
  <link href="lib/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
  <script src="lib/klippy-0.0.0.9500/js/klippy.min.js"></script>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
   href="../css/slidy_styles.css" />
  <meta name="duration" content="0" />
</head>
<body>
<div class="slide titlepage">
  <h1 class="title"><span class="course-title">Spatial Data Analysis with R </span><br/><span class="course-subtitle">BayGeo, Spring 2021</span></h1>
  <p class="author">
Getting Data from APIs <br/><img src='images/data-transfer_304x240x256.png'/>
  </p>
</div>
<div id="apis" class="slide section level1">
<h1>APIs</h1>
<script language="javascript" type="text/javascript">w3c_slidy.mouse_click_enabled = false;</script>
<script>
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<p>API = <em>Application Programming Interface</em>.</p>
<p>It is both a translator and a messenger between two different programs.</p>
<p>Common Uses of APIs</p>
<div class="indented2">
<ul>
<li>call libraries written in C from R</li>
<li>request data and have it returned in a known format</li>
<li>access ‘big’ database and/or computing power (e.g., geocoding)</li>
</ul>
</div>
</div>
<div id="importing-data-from-the-cloud" class="slide section level1">
<h1>Importing Data from the Cloud</h1>
<p>There are three general approaches to importing data directly into R:</p>
<div class="compact">
<ol style="list-style-type: decimal">
<li><p>Data packages - come with bundled datasets</p></li>
<li><p>API packages - provide custom functions to download data from specific sources</p></li>
<li><p>Write your own download code</p></li>
</ol>
</div>
</div>
<div id="data-packages" class="slide section level1">
<h1>Data Packages</h1>
<p>Packages that primarily contain datasets are commonly known as <em>data packages</em>.</p>
<p>When you install the package, you’re actually downloading the data to your hard drive. This makes them convenient - provided you have enough hard drive space to install the package!</p>
<p>Examples:</p>
<div class="compact">
<ul>
<li>spData</li>
<li><a href="https://github.com/Nowosad/spDataLarge" target="_blank" rel="noopener">spDataLarge</a></li>
<li><a href="https://lincolnmullen.com/software/usaboundaries/" target="_blank" rel="noopener">USAboundaries</a><br />
</li>
</ul>
</div>
<p><br />
</p>
<div class="tip">
<p>CRAN doesn’t like to host data package because they can be rather large, so you may have to install them from another repository such as GitHub, Bioconductor, etc.</p>
</div>
</div>
<div id="api-packages" class="slide section level1">
<h1>API Packages</h1>
<p>The the next best option is to find an API package that is designed to download data.</p>
<p>API Packages have custom functions to download specific datasets from specific online data portals.</p>
<p>Example: tidycensus</p>
<p><code>tidycensus</code> makes it easy to grab census data. The following command will download median household income from the American Community Survey by census tracks in San Francisco County, and return the results as a tibble.</p>
<div class="indented4">
<pre><code>median_hhinc_tbl &lt;- tidycensus::get_acs(state = &quot;CA&quot;, 
                                     county = &quot;San Francisco&quot;, 
                                     geography = &quot;tract&quot;, 
                                     variables = &quot;B19013_001&quot;)</code></pre>
</div>
<p>Benefits of using an API package:</p>
<div class="compact">
<ul>
<li>download only the data you need, when you need it</li>
<li>user-friendly functions help you select the data you’re interested in</li>
<li>depending on the API, you may be able to filter data on the server</li>
<li>results are usually returned as a common R data class (e.g., sf data frame, raster, etc.)</li>
</ul>
</div>
<p><br />
</p>
<p>Example API packages:</p>
<div class="compact">
<ul>
<li><code>raster::getdata()</code></li>
<li><a href="https://github.com/walkerke/tigris" target="_blank" rel="noopener"><code>tidycensus</code></a><br />
</li>
<li><a href="https://github.com/walkerke/tigris" target="_blank" rel="noopener"><code>tigris</code></a><br />
</li>
<li><a href="http://gshs-ornl.github.io/wbstats/" target="_blank" rel="noopener"><code>wbstats</code></a><br />
</li>
<li>see also: <a href="https://ropensci.org/packages/data-access/" target="_blank" rel="noopener"><em>ROpenSci Data Access Packages</em></a></li>
</ul>
</div>
<p><br />
</p>
<div class="tip">
<p>There are <strong>100s</strong> of ‘niche’ API Packages in the R universe. For example <a href="https://cran.r-project.org/web/packages/twitteR/" target="_blank" rel="noopener">twitteR</a> is an R package which provides access to the Twitter API.</p>
<p>To search for an API package for a specific data source, try Google or search <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html" target="_blank" rel="noopener">CRAN packages by name</a>.</p>
</div>
<!------ tip ------>
<!----- https://rviews.rstudio.com/2017/11/01/r-data-packages/ ---->
<!----
Example:

raster::getdata; 
file:///D:/Workshops/R-Spatial/rspatial_mod/outputs/rspatial_bgs20/docs/slides/16_raster1-import-plot.html#(1)
BONUS: Importing Spatial Data from the Cloud
The raster package has a function that can download a handful of spatial layers from public sources. raster::getData() can download the following datasets directly into R:

file:///D:/Workshops/R-Spatial/rspatial_mod/outputs/rspatial_bgs20/docs/slides/11_mapping-covid19.html#(5) (TIGRIS EXAMPLE)

---->
</div>
<div id="api-package-examples" class="slide section level1">
<h1>API Package Examples</h1>
<h2 id="feddata">FedData</h2>
<p><a href="https://github.com/ropensci/FedData" target="_blank" rel="noopener">FedData</a> is an R package implementing functions to automate downloading geospatial data available from several federated data sources, including:</p>
<div class="indented2 singlespace">
<ul>
<li>USGS National Elevation Dataset (NED)<br />
</li>
<li>USGS National Hydrography Dataset (NHD)<br />
</li>
<li>USDA Soil Survey Geographic database (SSURGO)<br />
</li>
<li>NOAA Global Historical Climatology Network (GHCN)<br />
</li>
<li>Oak Ridge National Lab gridded estimates of daily weather parameters (Daymet)</li>
<li>NOAA International Tree Ring Data Bank (ITRDB)<br />
</li>
<li>National Land Cover Database (NLCD)<br />
</li>
<li>NASS Cropland Data Layer<br />
</li>
</ul>
</div>
<p><br />
</p>
<h2 id="dataretrieval"><code>dataRetrieval</code></h2>
<p><code>dataRetrieval</code> provides functions for importing USGS and EPA hydrologic and water quality data.</p>
<p><a href="https://owi.usgs.gov/R/dataRetrieval.html" class="uri">https://owi.usgs.gov/R/dataRetrieval.html</a></p>
<p><br />
</p>
<h2 id="caladaptr"><code>caladaptr</code></h2>
<p>Access data from Cal-Adapt</p>
<p><a href="https://ucanr-igis.github.io/caladaptr/" class="uri">https://ucanr-igis.github.io/caladaptr/</a></p>
</div>
<div id="write-your-own-direct-download-code" class="slide section level1">
<h1>Write Your Own Direct Download Code</h1>
<p>Many functions that import data from local files can also be used to download data from online sources, provided the URL returns data in a standard format. Examples:</p>
<pre><code>## Import a GeoJSON file 
sf_nb_sf &lt;- sf::read_sf(&quot;https://data.sfgov.org/resource/xfcw-9evu.geojson&quot;)

## Import a csv file from GiHub
ca_breweries_df &lt;- read.csv(&quot;https://raw.githubusercontent.com/UCANR-IGIS/rspatial_data/master/data/ca_breweries.csv&quot;)</code></pre>
<p><br />
</p>
<div class="tip">
<p>If you need to download a file programmatically, use <code>download.file()</code>.</p>
<p>If you need to download a zip file, you can download it to a temp file, unzip the contents where they should go (with <code>unzip()</code>), then delete the temp file.</p>
</div>
<p><br />
</p>
<h3 id="example-land-processes-distributed-active-archive-center-lp-daac">Example: Land Processes Distributed Active Archive Center (LP DAAC)</h3>
<ul>
<li><p>Data Prep Scripts: <a href="https://lpdaac.usgs.gov/tools/data-prep-scripts/" class="uri">https://lpdaac.usgs.gov/tools/data-prep-scripts/</a></p></li>
<li><p>E-Learning page: <a href="https://lpdaac.usgs.gov/resources/e-learning/" class="uri">https://lpdaac.usgs.gov/resources/e-learning/</a></p>
<ul>
<li>videos, view tutorials, and learn more about how to download and work with the data distributed by the LP DAAC.</li>
</ul></li>
</ul>
<div class="tip">
<p>An alternative approach to downloading data from the cloud is known as ‘web scraping’. This is far less desirable than an API because it is i) inefficient, and ii) easily broken. But if the data source doesn’t support an API, web scraping may be your only option.</p>
</div>
</div>
<div id="notebook-exercise" class="slide section level1">
<h1>Notebook Exercise</h1>
<p><em>coming soon!</em></p>
<!------
# Notebook Exercise (outline)

Example of bundled data example: USAboundaries

Download roads from tigris - include a spatial query if possible

Download a zip into temp space. Unzip it. 

---->
</div>
<div id="api-authentication" class="slide section level1">
<h1>API Authentication</h1>
<p>Many APIs require you to register for access. This allows them to track which users are submitting queries and manage demand.</p>
<p>If you submit too many queries too quickly, you might be rate-limited or your requests may be temporarily blocked!</p>
<p>In some cases, a data provider may require authentication as part of a paid subscription program.</p>
<p><br />
</p>
<h2 id="api-keys">API Keys</h2>
<p>A common way of providing authentication is through <em>API keys</em> or <em>tokens</em>. These are essentially like private passwords specifically for accessing data through an API.</p>
<p>Many API packages have a function to save your API key in memory, so you don’t have to type it in every time you fetch some data.</p>
<p>For example, the Census Bureau requires users to <a href="https://api.census.gov/data/key_signup.html" target="_blank" rel="noopener">create an account</a> (free) and generate an API key. The excellent <code>tidycensus</code> package provides a function to enter your key before you start making requests for data:</p>
<div class="indented4 indented2r">
<pre><code>tidycensus::census_api_key(&quot;05b44067246sdsfsdfqwerty6a615910263ea93&quot;)</code></pre>
</div>
</div>
<div id="protecting-your-api-key" class="slide section level1">
<h1>Protecting your API Key</h1>
<p>API keys are like passwords that provide access to services that in theory (depending on the service) you could be billed for.</p>
<p>However unlike passwords, API keys are often transmitted <em>unencrypted</em> from web pages or scripts like R or Python. Careless developers will even hardcode their API key in their HTML code or R script, making it very easy to discover.</p>
<p>There are two things you can do to protect your API key.</p>
<h3 id="restrict-its-use-andor-period-of-validity">1. Restrict its Use and/or Period of Validity</h3>
<div class="indented2">
<p>Some cloud platforms (e.g., Google) allow you to <strong>limit an API key to specific services</strong> (e.g., just downloading background tiles, or just geocoding).</p>
<p>Some services allow you to limit the the API key to specific application(s) (i.e., only calls from <strong>specific IP addresses</strong> or domain names will be processed).</p>
<p>Some services (e.g., ESRI Geocoding Service) allow you to <strong>specify an expiration date</strong> on API keys.</p>
</div>
<h3 id="dont-put-the-api-key-in-code">2. Don’t Put the API Key in Code</h3>
<div class="indented2">
<p>Although it’s very convenient to simply paste your API in your code, anyone who sees your script will be able to see and potentially use your key.</p>
<div class="indented4 indented2r">
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">## Don&#39;t do this!!</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>myKey &lt;-<span class="st"> &quot;R5p7S006s7KsdfV7UYncAqUVxBN7sf2c5p@CgasdfFzoOo5Q&quot;</span></span></code></pre></div>
</div>
<p>A better technique is to store your key in a file somewhere where it won’t be accidentally shared. Then you read the file in your script, saving the key to a variable. It is still unencrypted in memory, so this isn’t very secure, but at least it won’t in your code and be accidentally shared on GitHub.</p>
<p>The following commands will read the first line of a text file like the one shown below, and save the results to a variable.</p>
<div class="indented4 indented2r">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>api_fn &lt;-<span class="st"> &quot;~/my-google-geocode-api.txt&quot;</span>  <span class="co">## File located in &#39;home&#39; folder (My Documents)</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>f &lt;-<span class="st"> </span><span class="kw">file</span>(api_fn, <span class="dt">open =</span> <span class="st">&quot;rt&quot;</span>)           <span class="co">## create a (file) connection object</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>mykey_google &lt;-<span class="st"> </span><span class="kw">readLines</span>(f, <span class="dt">n=</span><span class="dv">1</span>)        <span class="co">## n=1 read first line only </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">close</span>(f)</span></code></pre></div>
</div>
<p><img src="images/api_text-file.png" /></p>
</div>
<!--- indented2 --->
<p><br />
</p>
<div class="tip">
<p>You can also save your API key as a <code>*.RData</code> file with the <code>save()</code> function, the same way you would save any R object, and bring it back into R with <code>load()</code>.</p>
<p>For additional security, save the file with your API key in an <strong>encrypted folder or drive</strong>.</p>
<p>To save your API keys in your operating system’s credential store (even more secure), see the <a href="https://github.com/r-lib/keyring" target="_blank" rel="noopener"><code>keyring</code></a> package.</p>
<p>See also: <a href="https://developers.google.com/maps/api-key-best-practices" target="_blank"><em>Google API Key Best Practices</em></a>.</p>
</div>
</div>
<div id="summary" class="slide section level1">
<h1>Summary</h1>
<p>Today we saw:</p>
<div class="compact">
<ul>
<li>how to find and use <strong>data packages</strong><br />
</li>
<li>examples of <strong>API packages</strong><br />
</li>
<li>techniques for writing your own <strong>direct import</strong> code<br />
</li>
<li>how to protect your <strong>API keys</strong><br />
</li>
</ul>
</div>
<div class="infobox">
<p>Resources:</p>
<p><a href="https://cfss.uchicago.edu/notes/application-program-interface/" target="_blank" rel="noopener">Using APIs to get data</a></p>
</div>
<p>
<br/>
<hr/>
<strong>Next: </strong> <a href="socrata-api.html">Using the Socrata API</a>
</p>
</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
